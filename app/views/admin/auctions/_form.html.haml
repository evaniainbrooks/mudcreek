= form_with model: [:admin, auction] do |f|
  - if auction.errors.any?
    .alert.alert-danger
      %h5.alert-heading
        %i.bi.bi-exclamation-triangle-fill.me-2
        = pluralize(auction.errors.count, "error")
        prohibited this auction from being saved:
      %ul.mb-0
        - auction.errors.full_messages.each do |message|
          %li= message

  .mb-3
    = f.label :name, class: "form-label"
    = f.text_field :name, class: "form-control #{'is-invalid' if auction.errors[:name].any?}", required: true
    - if auction.errors[:name].any?
      .invalid-feedback= auction.errors[:name].to_sentence

  .row.g-3.mb-3
    .col-md-6
      = f.label :starts_at, "Starts At", class: "form-label"
      = f.datetime_local_field :starts_at, class: "form-control #{'is-invalid' if auction.errors[:starts_at].any?}",
          value: auction.starts_at&.strftime("%Y-%m-%dT%H:%M")
      - if auction.errors[:starts_at].any?
        .invalid-feedback= auction.errors[:starts_at].to_sentence
    .col-md-6
      = f.label :ends_at, "Ends At", class: "form-label"
      = f.datetime_local_field :ends_at, class: "form-control #{'is-invalid' if auction.errors[:ends_at].any?}",
          value: auction.ends_at&.strftime("%Y-%m-%dT%H:%M")
      - if auction.errors[:ends_at].any?
        .invalid-feedback= auction.errors[:ends_at].to_sentence

  .mb-3.form-check
    = f.check_box :published, class: "form-check-input"
    = f.label :published, class: "form-check-label"

  .mb-3.form-check
    = f.check_box :reconciled, class: "form-check-input"
    = f.label :reconciled, class: "form-check-label"

  .mb-3.form-check
    = f.check_box :auto_approve, class: "form-check-input"
    = f.label :auto_approve, "Auto-approve registrations", class: "form-check-label"

  .mb-3
    = f.label :description, class: "form-label"
    = f.rich_text_area :description, class: "form-control #{'is-invalid' if auction.errors[:description].any?}"
    - if auction.errors[:description].any?
      .invalid-feedback.d-block= auction.errors[:description].to_sentence

  .mb-3
    = f.label :poster, class: "form-label"
    = f.file_field :poster, class: "form-control #{'is-invalid' if auction.errors[:poster].any?}", accept: "image/*"
    - if auction.errors[:poster].any?
      .invalid-feedback= auction.errors[:poster].to_sentence
    - if auction.poster.attached?
      .mt-2.d-flex.align-items-center.gap-2
        = image_tag auction.poster.variant(resize_to_fill: [120, 80]), class: "rounded", style: "object-fit: cover"
        = button_to admin_auction_path(auction), method: :patch, params: { remove_poster: true },
            class: "btn btn-sm btn-outline-danger",
            form: { data: { turbo_confirm: "Remove poster?" } } do
          %i.bi.bi-x-lg.me-1
          Remove

  .mb-3
    = f.label :cover_photo, "Cover Photo", class: "form-label"
    = f.file_field :cover_photo, class: "form-control #{'is-invalid' if auction.errors[:cover_photo].any?}", accept: "image/*"
    - if auction.errors[:cover_photo].any?
      .invalid-feedback= auction.errors[:cover_photo].to_sentence
    - if auction.cover_photo.attached?
      .mt-2.d-flex.align-items-center.gap-2
        = image_tag auction.cover_photo.variant(resize_to_fill: [120, 80]), class: "rounded", style: "object-fit: cover"
        = button_to admin_auction_path(auction), method: :patch, params: { remove_cover_photo: true },
            class: "btn btn-sm btn-outline-danger",
            form: { data: { turbo_confirm: "Remove cover photo?" } } do
          %i.bi.bi-x-lg.me-1
          Remove

  %hr.my-4

  %h6.mb-3
    %i.bi.bi-geo-alt.me-1
    Location (optional)

  = f.fields_for :address do |addr|
    .mb-3
      = addr.label :street_address, "Street Address", class: "form-label"
      = addr.text_field :street_address, class: "form-control"
    .row.g-3.mb-3
      .col-md-6
        = addr.label :city, "City", class: "form-label"
        = addr.text_field :city, class: "form-control"
      .col-md-6
        = addr.label :province, "Province / State", class: "form-label"
        = addr.text_field :province, class: "form-control"
    .row.g-3.mb-3
      .col-md-6
        = addr.label :postal_code, "Postal Code", class: "form-label"
        = addr.text_field :postal_code, class: "form-control"
      .col-md-6
        = addr.label :country, "Country", class: "form-label"
        = addr.text_field :country, class: "form-control"

  .d-flex.gap-2.mt-4
    = f.submit class: "btn btn-primary"
    = link_to "Cancel", admin_auctions_path, class: "btn btn-outline-secondary"
