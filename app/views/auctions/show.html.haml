- cover_style = @auction.cover_photo.attached? ? "background-image: url('#{url_for(@auction.cover_photo)}'); background-size: cover; background-position: center;" : ""

.row.g-0.align-items-stretch{ style: "min-height: 70vh" }
  .col-lg-4.bg-body.border-end.p-4.p-lg-5
    .position-sticky{ style: "top: 1.5rem" }
      - if @auction.poster.attached?
        = image_tag @auction.poster, class: "img-fluid rounded-3 mb-4 shadow-sm w-100 object-fit-cover"

      %h1.fw-bold.lh-tight.mb-4= @auction.name

      - if @auction.starts_at
        .d-flex.align-items-center.gap-2.mb-2.text-muted
          %i.bi.bi-calendar-event.flex-shrink-0
          %span= @auction.starts_at.to_fs(:long)

      - if @auction.ends_at
        .d-flex.align-items-center.gap-2.mb-2.text-muted
          %i.bi.bi-calendar-check.flex-shrink-0
          %span= @auction.ends_at.to_fs(:long)

      - if @auction.address
        - addr = @auction.address
        .d-flex.align-items-start.gap-2.mb-2.text-muted
          %i.bi.bi-geo-alt-fill.flex-shrink-0.mt-1
          %span= [ addr.street_address, addr.city, addr.province, addr.country ].compact_blank.join(", ")

      - if @auction.description.present?
        %hr.my-4
        .auction-description= @auction.description

  .col-lg-8.position-relative{ style: cover_style }
    - if @auction.cover_photo.attached?
      .position-absolute.top-0.start-0.w-100.h-100{ style: "background: rgba(0,0,0,0.5); z-index: 0" }

    .position-relative.p-4.p-lg-5{ style: "z-index: 1" }
      - if @listings.any?
        .row.row-cols-1.row-cols-sm-2.row-cols-xl-3.g-4
          = render partial: "listings/listing", collection: @listings, as: :listing
      - else
        - text_class = @auction.cover_photo.attached? ? "text-white" : "text-muted"
        .py-5.text-center
          %i.bi.bi-tag.mb-3.d-block{ class: text_class, style: "font-size: 3rem" }
          %p.mb-0{ class: text_class } No listings available for this auction yet.
