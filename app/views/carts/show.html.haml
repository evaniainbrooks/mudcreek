- content_for :title, "My Cart"

%h1.fw-bold.mb-4 My Cart

- if @cart_items.empty?
  = render EmptyStateComponent.new(icon: "cart-x",
      message: "Your cart is empty.",
      link_text: "Browse Listings",
      link_url: listings_path)
- else
  .table-responsive
    %table.table.align-middle
      %thead
        %tr
          %th Listing
          %th.text-end Price
          %th
      %tbody
        - @cart_items.each do |item|
          %tr
            %td
              = link_to item.listing.name, listing_path(item.listing), class: "text-decoration-none fw-semibold"
              - if item.listing.tax_exempt?
                %span.badge.bg-secondary.ms-2.fw-normal Tax Exempt
            %td.text-end= number_to_currency(item.listing.price)
            %td.text-end
              = button_to cart_item_path(item), method: :delete, class: "btn btn-sm btn-outline-danger", form: { data: { turbo_confirm: "Remove from cart?" } } do
                %i.bi.bi-trash
      %tfoot
        %tr.border-top
          %td.text-muted Subtotal
          %td.text-end.text-muted= number_to_currency(@subtotal)
          %td
        %tr
          %td.text-muted
            = "Tax (#{(SALES_TAX_RATE * 100).to_i}%)"
          %td.text-end.text-muted= number_to_currency(@tax)
          %td
        %tr.border-top.border-2
          %th.fs-5 Total
          %th.text-end.fs-5= number_to_currency(@total)
          %th
